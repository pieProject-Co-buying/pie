<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<div th:fragment="mainPageCarousel">
	<div id="headerCarousel" class="carousel slide overflow-hidden"
		data-ride="carousel">
		<div class="carousel-inner">
			<div class="carousel-item hyej-h100vh active"></div>
			<div class="carousel-item hyej-h100vh"></div>
			<div class="carousel-item hyej-h100vh"></div>
		</div>
		<button class="carousel-control-prev" type="button"
			data-target="#headerCarousel" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span> <span
				class="sr-only">Previous</span>
		</button>
		<button class="carousel-control-next" type="button"
			data-target="#headerCarousel" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span> <span
				class="sr-only">Next</span>
		</button>
	</div>
</div>


<!-- main fragment -->
<div th:fragment="mainPageContents">



	<!-- ###############################################
secion1 #sec1 - 우리동네 공동구매 영역
############################################### -->
	<section class="pie-section-py mt-5">


		<div class="container-fluid my-5">

			<div class="row">

				<div class="col-12 p-0">

					<div id="section1Carousel" class="carousel slide"
						data-ride="carousel">

						<div class="carousel-inner">

							<div class="row">

								<div class="carousel-item active col">

									<div class="row">
										<div class="col-12 col-md-6">
											<img src="imgs/index-share.jpg"
												class="img-fluid" alt="...">
										</div>
										<div class="col-12 col-md-6 mt-5 mt-md-0">
											<img src="imgs/share.jpg" alt=""
												class="d-block img-fluid w-100" />

										</div>
									</div>

								</div>


								<div class="carousel-item col">

									<div class="row">
										<div class="col-12 col-md-6">
											<img src="imgs/index-comu.jpg"
												class="d-block w-100 img-fluid"
												alt="...">
										</div>
										<div class="col-12 col-md-6 mt-5 mt-md-0">
											<img src="imgs/together.jpg" alt=""
												class="d-block img-fluid w-100" />

										</div>
									</div>

								</div>



								<div class="carousel-item col">

									<div class="row">
										<div class="col-12 col-md-6">
											<img src="imgs/index-baby.jpg"
												class="d-block w-100 img-fluid"
												alt="...">
										</div>
										<div class="col-12 col-md-6 mt-5 mt-md-0">
											<img src="imgs/shareTogetherPie.jpg" alt=""
												class="d-block img-fluid w-100" />
										</div>
									</div>

								</div>


							</div>

						</div>

					</div>

				</div>

			</div>



			<div class="row mt-5">

				<div class="col-12 col-md-6 d-none d-md-block">
					<button class="carousel-control-prev" type="button"
						data-target="#section1Carousel" data-slide="prev">
						<span class="hj-carousel-control-prev-icon" aria-hidden="true">
							<svg xmlns="http://www.w3.org/2000/svg" fill="black"
								class="bi bi-arrow-left-circle" viewBox="0 0 16 16">
							  <path fill-rule="evenodd"
									d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z" />
							</svg>
						</span> <span class="sr-only">Previous</span>
					</button>
					<button class="carousel-control-next" type="button"
						data-target="#section1Carousel" data-slide="next">
						<span class="hj-carousel-control-next-icon" aria-hidden="true">
							<svg xmlns="http://www.w3.org/2000/svg" fill="black"
								class="bi bi-arrow-right-circle" viewBox="0 0 16 16">
							  <path fill-rule="evenodd"
									d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5z" />
							</svg>
						</span> <span class="sr-only">Next</span>
					</button>
				</div>

				<div class="col-12 col-md-6">
					<div class="row  justify-content-center">
						<div
							class="text-center font-weight-bold text-carousel-item hj-carousel-txt h5 mx-4 mx-md-3 mx-lg-5"
							role="button">나누다</div>
						<div
							class="text-center font-weight-bold text-carousel-item hj-carousel-txt h5 mx-4 mx-md-3 mx-lg-5"
							role="button">함께하다</div>
						<div
							class="text-center font-weight-bold text-carousel-item hj-carousel-txt h5 mx-4 mx-md-3 mx-lg-5"
							role="button">파이하다</div>
					</div>
				</div>

			</div>

		</div>
	</section>


	<!-- ###############################################
secion1 #sec1 - 우리동네 공동구매 영역
############################################### -->
	<section class="pie-section-py">
		<div class="container">
		
		
			<div class="row">

				<div class="col">
				
				
					<div class="row">
						<div class="col-9">
							<h1 class="text-center text-md-left">우리동네 파이</h1>
						</div>

						<div class="col-3 text-center">
								<a class="btn pie-btn-red w-100" th:href="@{'townBuySearch'}">더 보기</a>
						
						</div>							
						
					</div>
					
					

					<h4 class="mb-5 mt-5 text-center text-md-left">조회수 BEST 12</h4>
					
					<div
						class="d-flex align-items-center justify-content-between w-100">

						
					</div>
                                                                         

					<div class="card-columns">
			
	
						<!-- 최대 노출은 12개까지만 하고, 더보기 버튼으로 페이지 이동  &lt;로 갯수 설정함  -->
						
						<div th:each="tBoard, iterStat : ${tlist}" th:if="${iterStat.index} &lt; 12">
						
						    <a class="card hj-radius-30 hj-main_town_hover" th:href="@{'townBuyproduct?num=' + ${tBoard.getTo_num()}}">
						        <img th:src="@{'/imgs/test/' + ${tBoard.getTo_productImg().substring(0,tBoard.getTo_productImg().indexOf('/'))}}"
						             class="card-img-top hj-radius-30 hj-main-product-img"
						             alt="...">
						             
						             <div class="position-absolute d-none p-3" style="top: 0; right: 0;">
						             	<div>
						             		<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
											  <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"/>
											</svg>
						             		<span th:text="${tBoard.getTo_hit()}" class="h5 ml-2"></span>
						             	</div>
						             </div>

				                    <div class="position-absolute d-none p-3" style="bottom: 0; left: 0;">
				                    
				                    	<div th:text="${tBoard.getTo_category}"></div>
				                        <h5 th:text="${tBoard.getTo_title}" class="text-bold"></h5>
				                        
				                        <div class="row">
				                        	<div class="col w-100 d-flex">
				                        		<img th:src="@{'imgs/profiles/'+${tBoard.getTo_profileImg()}}" alt="" class="hj-chat-proImg-small mr-3"/>
						                        <h5 th:text="${tBoard.getTo_nickname}"></h5>
				                        	</div>
				                        </div>

				                      
				                        
				                        

				                    </div>
		

						    </a>
		
						    
						    
						</div>

					</div>
				</div>
			</div>
			
			
			
			
		
		
			<div class="row mb5">
				<div class="col">
					
					<h4 class="mb-5 mt-5 text-center text-md-left">좋아요 BEST 12</h4>

					<div class="card-columns">
			
	
						<!-- 최대 노출은 9개까지만 하고, 더보기 버튼으로 페이지 이동 -->
						<div th:each="t2Board, iterStat : ${tlist2}" th:if="${iterStat.index} &lt; 12">
						    <a class="card hj-radius-30 hj-main_town_hover" th:href="@{'townBuyproduct?num=' + ${t2Board.getTo_num()}}">
						        <img th:src="@{'/imgs/test/' + ${t2Board.getTo_productImg().substring(0,t2Board.getTo_productImg().indexOf('/'))}}"
						             class="card-img-top hj-radius-30 hj-main-product-img"
						             alt="...">
						             
						             <div class="position-absolute d-none p-3" style="top: 0; right: 0;">
						             	<div>
						             		<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
											  <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
											</svg>
						             		<span th:text="${t2Board.getTo_like()}" class="ml-2 h5"></span>
						             	</div>
						             </div>

				                    <div class="position-absolute d-none p-3" style="bottom: 0; left: 0;">
				                    
				                    	<div th:text="${t2Board.getTo_category}"></div>
				                        <h5 th:text="${t2Board.getTo_title}" class="text-bold"></h5>
				                        
				                        <div class="row">
				                        	<div class="col w-100 d-flex">
				                        		<img th:src="@{'imgs/profiles/'+${t2Board.getTo_profileImg()}}" alt="" class="hj-chat-proImg-small mr-3"/>
						                        <h5 th:text="${t2Board.getTo_nickname}"></h5>
				                        	</div>
				                        </div>

				                      
				                        
				                        

				                    </div>
		

						    </a>
						    

						</div>
						

					</div>
				</div>
			</div>
			
			

			
		</div>

	</section>


	<!-- ###############################################
secion2 #sec2 - 대리공구 영역
############################################### -->


	<section id="sec2" class="pie-bg-lightgray pie-section-py">

		<div class="container ">

			<div
				class="d-flex align-items-center justify-content-between w-100 my-4">
				<h1
					class="mb-5 mt-5 text-center text-sm-left font-weight-bolder pie-c-red">대리공구(가제)</h1>
				<a class="btn btn-light" href="proxyBuyProducts"> <small>┼</small>
				</a>
			</div>
			<th:block th:if="${list==null||list.size()==0}">
				<div class="row">
					<div class="col">
						<hr class="my-5" />
						<p class="lead py-5">현재 작성된 글이 없습니다.</p>
						<hr class="my-5" />
					</div>
				</div>
			</th:block>


			<th:block th:if="${list!=null && list.size()!=0}">
				<div class="row hyej-best-gallery align-items-center">
					<div class="col-lg-6 col-md-8 mb-3 mb-md-2">
						<img src="imgs/bestMark.png" alt="best" id="bestMark"
							class="position-absolute" />
						<div class="container-fluid hyej-customCard pt-1 bg-white shadow">
							<div class="row border-bottom">
								<div class="col-12 px-5 py-3 d-flex align-items-center">
									<img th:src="@{'imgs/profiles/'+${list[0].getPr_profileImg()}}"
										class=" border rounded-circle pie-profilePic-mid align-self-center"
										id="bestProfileImg" alt=>
									<div class="pl-3 pie-view-text pie-omitted d-flex flex-column">
										<small class="m-0 font-weight-bold"
											th:text="${list[0].getPr_nickname()}" id="bestNickName">아이디</small>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col p-0">
									<div id="proxyMainCarousel" class="carousel slide"
										data-ride="carousel">
										<ol class="carousel-indicators">
											<th:block
												th:each="i : ${#numbers.sequence(0,list[0].getPr_productImgs().length-1)}">
												<li data-target="#proxyMainCarousel"
													th:attr="data-slide-to=${i}"></li>
											</th:block>
										</ol>
										<div class="carousel-inner">
											<th:block th:each="img : ${list[0].getPr_productImgs()}">
												<div class="carousel-item">
													<img th:src="@{'imgs/test/'+${img}}" class="d-block w-100"
														alt="...">
												</div>
											</th:block>

										</div>
										<button class="carousel-control-prev" type="button"
											data-target="#proxyMainCarousel" data-slide="prev">
											<span class="carousel-control-prev-icon" aria-hidden="true"></span>
											<span class="sr-only">Previous</span>
										</button>
										<button class="carousel-control-next" type="button"
											data-target="#proxyMainCarousel" data-slide="next">
											<span class="carousel-control-next-icon" aria-hidden="true"></span>
											<span class="sr-only">Next</span>
										</button>
									</div>
								</div>
							</div>
							<div class="row px-5 pt-5">
								<div class="col">
									<p class="mb-1 pie-c-red font-weight-bolder">
										<small id="bestCategory" th:text="${list[0].getPr_category()}"></small>
									</p>
									<h4 id="bestTitle" class="text-truncate mb-4"
										th:text="${list[0].getPr_title()}"></h4>
									<div id="bestContent" class="hyej-text-truncate">
										<p th:text="${list[0].getPr_content()}"></p>
									</div>
									<div class="">
										<small id="bestTags"> <th:block
												th:if="${list[0].getPr_tags()!=null}">
												<th:block
													th:each="i: ${#numbers.sequence(1, list[0].getPr_tags()?.length - 1)}">
													<span class="badge badge-light"
														th:text="|#${list[0].getPr_tags()[i]}|">#태그</span>
												</th:block>
											</th:block>
										</small>
									</div>
									<div class="d-flex justify-content-end">
										<div class="d-flex align-items-center">
											<span class="pie-heart-icon active pie-icons mr-2"></span> <span
												id="bestLike" th:text=${list[0].getPr_like()}></span>
										</div>
										<div class="d-flex align-items-center mx-3">
											<span class="pie_view-icon active pie-icons mr-2"></span> <span
												id="bestHit" th:text=${list[0].getPr_hit()}></span>
										</div>
										<div class="d-flex align-items-center">
											<span class="pie-man-icon active pie-icons mr-2"></span> <span
												id="bestNow" th:text=${list[0].getPr_personnelNow()}></span>
											<span>/</span> <span id="bestMax"
												th:text=${list[0].getPr_personnelMax()}></span>
										</div>
									</div>
								</div>
							</div>
							<div class="row px-5 py-5">
								<div class="col">
									<a th:href="@{'viewProxyBoard?num='+${list[0].getPr_num()}}"
										class="btn pie-btn-red btn-block" id="bestBtn">보러가기</a>
								</div>
							</div>

						</div>
					</div>
					<div class="col-lg-6 col-md-4 px-5">
						<div class="row no-gutters justify-content-center bests">
							<th:block th:each="board : ${list}">
								<div class="col-md-12 col-2 mx-2 mx-md-0 mb-md-4 bestProduct">
									<div class="hyej-custom-img-box position-relative">
										<img
											th:src="@{'/imgs/test/' + ${board.getPr_productImg().substring(0,board.getPr_productImg().indexOf('/'))}}"
											alt="" class="shadow" />
										<div class="hyej-cover">
											<p class="d-none d-lg-block m-0"
												th:text="${board.getPr_category()}"></p>
											<h3 class="d-none d-lg-block text-truncate"
												th:text="${board.getPr_title()}"></h3>
										</div>
									</div>
								</div>
							</th:block>
						</div>
					</div>
				</div>
			</th:block>
		</div>
	</section>


	<section class="pie-section-py overflow-hidden">

		<div class="container">
			<div class="row">
				<div class="col">
					<h1 class="mb-5 mt-5 text-center text-sm-left">서비스 공유</h1>
				</div>
			</div>
		</div>

		<div class="row position-relative hyej-carousel-custom pb-5 mb-5">
			<div class="col pb-5 mb-5">
				<div class="owl-carousel owl-theme">
					<div class="item">
						<h4>
							<img src="imgs/netflix2.png" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/watcha.jpg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/xbox.jpg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/ridibooks.jpg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/youtube.webp" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4 class="">
							<img src="imgs/disney.png" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/steam.jpg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/spotify.jpg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/nintendoOnline.jpeg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
					<div class="item">
						<h4>
							<img src="imgs/milli.jpg" alt="" class="img-fluid" style="height:500px">
						</h4>
					</div>
				</div>
			</div>
		</div>

	</section>


	<script type="text/javascript" th:inline="javascript">
		var list = /*[[${list}]]*/[];
		console.log(list);
	</script>
	<script>
		$(function() {
			$("#proxyMainCarousel").find(".carousel-item").eq(0).addClass(
					"active");
			$("#proxyMainCarousel").find("li").eq(0).addClass("active");

			$(".bests").find(".bestProduct").eq(0).hide();

			$(".bests")
					.find(".bestProduct")
					.click(
							function() {
								$(".bests").find(".bestProduct").show();
								let idx = $(this).index();
								$("#bestProfileImg").attr(
										"src",
										'imgs/profiles/'
												+ list[idx].pr_profileImg);
								$("#bestNickName").text(list[idx].pr_nickname);
								$("#bestTitle").text(list[idx].pr_title);
								$("#bestLike").text(list[idx].pr_like);
								$("#bestHit").text(list[idx].pr_hit);
								$("#bestNow").text(list[idx].pr_personnelNow);
								$("#bestMax").text(list[idx].pr_personnelMax);
								$("#bestCategory").text(list[idx].pr_category)

								$("#bestTags").empty();

								console.log(list[idx].pr_tags);
								if (list[idx].pr_tags != null) {
									for (i = 1; i < list[idx].pr_tags.length; i++) {
										$("#bestTags").append(
												'<span class="badge badge-light">#'
														+ list[idx].pr_tags[i]
														+ '</span>')
									}
								}

								let el = list[idx].pr_content;
								const newText = el.replace(/<[^>]*>?/g, '');

								console.log(newText);

								$("#bestContent")
										.html("<p>" + newText + "</p>");
								$("#bestBtn").attr(
										"href",
										'viewProxyBoard?num='
												+ list[idx].pr_num);
								$("#proxyMainCarousel").find(
										".carousel-indicators").empty();
								for (i = 0; i < list[idx].pr_productImgs.length; i++) {
									$("#proxyMainCarousel")
											.find(".carousel-indicators")
											.append(
													'<li data-target="#proxyMainCarousel" data-slide-to="'+i+'"></li>');
								}
								$("#proxyMainCarousel").find("li").eq(0)
										.addClass("active");
								$("#proxyMainCarousel").find(".carousel-inner")
										.empty();
								for (i = 0; i < list[idx].pr_productImgs.length; i++) {
									$("#proxyMainCarousel")
											.find(".carousel-inner")
											.append(
													'<div class="carousel-item"><img src="imgs/test/'+list[idx].pr_productImgs[i]+'" class="d-block w-100" alt="..."></div>');
								}
								$("#proxyMainCarousel").find(".carousel-item")
										.eq(0).addClass("active");
								$(this).hide();
							})
		})
	</script>

	<script src="js/main_town_caruousel.js"></script>
	

<script>
	
	/* 호버시 제품 제목 보이게 */
    $(document).ready(function() {
        $('.hj-main_town_hover').hover(
        		
            function() {
                $(this).find('.position-absolute').removeClass('d-none');
            },
            
            function() {
                $(this).find('.position-absolute').addClass('d-none');
            }
        );
    });
    
</script>
</div>

</html>