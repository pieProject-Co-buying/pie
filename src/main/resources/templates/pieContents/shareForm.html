<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/boardForm}">
<head>
<!-- include summernote css/js -->
<link
	href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css"
	rel="stylesheet">
</head>


<!--<h1>Bootstrap 기본설정완료</h1>-->
<div layout:fragment="formContent" class="col">
	<!--------------------------------게시글 타이틀-------------------------------->
	<!--container-->
	<!--------------------------------게시글 로직-------------------------------->
	<div class="container">
		<div class="row mb-5">
			<div class="col text-center">
				<h3 class="border-bottom d-inline-block">게시물 작성</h3>
			</div>
		</div>
		<div class="row">
			<div class="col">
				<form action="insertBoard" enctype="multipart/form-data" method="post"
					name="townForm">
					<div class="form-group">
					<div class="dropdown">
						<button class="btn btn-block dropdown-toggle text-left bg-transparent border" type="button"
							data-toggle="dropdown" aria-expanded="false"> 카테고리 </button>
						<input type="hidden" id="h-input" value="" name="sh_category"/>
						<div class="dropdown-menu w-100">
							<a class="dropdown-item">OTT</a> <a
								class="dropdown-item">게임</a> <a
								class="dropdown-item">도서/음악</a>
						</div>
					</div>
					</div>
					<div class="form-group d-flex align-items-center">
						<img src="" alt="" class="rounded-circle" width="30" height="30" onerror="this.onerror=null; this.src='imgs/default.png';"/>
						<input type="text" class="pl-2 form-control-plaintext mt-1"
							id="exampleInputEmail1" name="sh_nickname" th:value="${session.nickName}" readonly>
						<input type="hidden" th:value="${session.userId}" name="sh_id"/>
					</div>
					<div class="form-group">
						<input type="text" class="form-control" id="exampleInputEmail1"
							aria-describedby="emailHelp" placeholder="제목" name="sh_title">
					</div>
					<textarea id="summernote" name="sh_content"></textarea>
					<div class="form-group pt-3">
						<p><b>상품가격</b></p>
						<input type="number" class="form-control" id="exampleInputEmail1" placeholder="가격" name="sh_price">
					</div>
					<div class="form-group pt-3">
						<p><b>진행여부</b></p>
						<select name="sh_process" id="sh_process" class="form-control">
							<option value="on">진행중</option>
							<option value="off">진행마감</option>
						</select>
					</div>
					<div class="form-group ">
						<p><b>모집인원</b></p>
						<input type="number" class="form-control" id="exampleInputEmail1" placeholder="모집인원" name="sh_personnelMax">
					</div>
					<div class="form-group">
						<p><b>모집마감일</b></p>
						<input type="date" class="form-control" id="exampleInputEmail1" name="sh_DeadLine">
					</div>
					<div class="form-group">
						<p><b>사진첨부</b></p>
						<input type="file" class="form-control" id="exampleInputEmail1" name="sh_filename">
					</div>
					<div class="form-group row justify-content-center mt-5">
						<div class="col-sm-9">
							<button type="submit" class="btn btn-block pie-btn-red"
								id="joinBtn">등록</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
	<!--게시글 로직 container-->
	<!--wrapper-->
	<script
		src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
	<script>
		$(document).ready(function() {
			$('#summernote').summernote({
				minHeight: 500,             // 최소 높이
	            maxHeight: null,             // 최대 높이
	            focus: true,                  // 에디터 로딩후 포커스를 맞출지 여부
	            lang: "ko-KR",					// 한글 설정
	            spellCheck: false,
	            callbacks: {	//이미지 첨부하는 부분
	               onImageUpload : function(files) {
	                    uploadSummernoteImageFile(files[0],this);
	                }
	            }
			});

			function uploadSummernoteImageFile(file, editor) {
				var resultUrl;
				
				data = new FormData();
				data.append("file", file);
				
				new Promise((succ, fail)=>{
				
				$.ajax({
					data : data,
					type : "POST",
					url : "/uploadSummernoteImageFile",
					contentType : false,
					processData : false,
					success : function(data) {
						$(editor).summernote('insertImage', data.url);
					}
				});
				})
				
			}

		});
	</script>
	<script>
	$(function(){
	    let category=$(".dropdown-menu a")
	    let input=$("#h-input");
	    let selectCategory=$(".dropdown button")
	    
	    category.click(function(){
    		let idx=$(this).index();
    
   	 	if(idx===0){
        	input.val("OTT");
        	$("#h-input").val("OTT");
        	selectCategory.text("OTT");
    	}else if(idx===1){
        	input.val("게임");
        	$("#h-input").val("게임");
        	selectCategory.text("게임");
    	}else if(idx===2){
        	input.val("도서/음악");
        	$("#h-input").val("도서/음악");
        	selectCategory.text("도서/음악");
    		}
		})
	})
	</script>
</div>

</html>