<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<!-- ###############################################
메인 캐로셀
############################################### -->
<div th:fragment="mainPageCarousel">
	<section class="pie-section-py pie-main-carousel-section my-5">
		<div class="row no-gutters">

			<div class="col-12 p-0">

				<div id="section1Carousel" class="carousel slide"
					data-ride="carousel">

					<div class="carousel-inner">

						<div class="row">

							<div class="carousel-item active col">

								<div class="row">
									<div class="col-12 col-lg-7">
										<img src="imgs/index-share.jpg"
											class="img-fluid pie-carousel-img" alt="...">
									</div>
									<div
										class="col-12 col-lg-5 mt-5 mt-lg-0 d-flex align-items-center justify-content-end">
										<div class="d-flex flex-column align-items-center mx-3 w-100 text-center">
											<h3
												class="pie-c-red p-3 font-weight-bold pie-carousel-subtitle">부담없이
												나누는 즐거움</h3>
											<img src="imgs/sharetext.png" alt=""
												class="d-block pie-carousel-title" />
											<p
												class="pie-c-darkgray px-3 mt-5 pie-carousel-text">
												과일 한 박스, 대용량 과자, 다인용 체육관 회원권 ... <br /> 소화하지 못하는 장바구니가 무겁게
												느껴지신 적은 없으신가요?
											</p>
											<h5 class="px-3 m-0 pie-carousel-subtext">우리 동네 이웃끼리 무거운 장바구니도 나눠들고<br/>
												가격도 나누세요!</h5>
										</div>

									</div>
								</div>

							</div>


							<div class="carousel-item col">

								<div class="row">
									<div class="col-12 col-lg-7">
										<img src="imgs/index-comu.jpg"
											class="img-fluid pie-carousel-img" alt="...">
									</div>
									<div
										class="col-12 col-lg-5 mt-5 mt-lg-0 d-flex align-items-center justify-content-end">
										<div class="d-flex flex-column align-items-center mx-3 w-100 text-center">
											<h3
												class="pie-c-red p-3 font-weight-bold pie-carousel-subtitle">함께하는 안전하고 즐거운 쇼핑</h3>
											<img src="imgs/togethertext.png" alt=""
												class="d-block pie-carousel-title" />
											<p
												class="pie-c-darkgray px-3 mt-5 pie-carousel-text">
												가격비교, 공구사기. <br /> 머리 아픈 사전조사는 그만!
											</p>
											<h5 class="px-3 m-0 pie-carousel-subtext">파이가 준비한 공구템으로 안심하고 함께 쇼핑해요!</h5>
										</div>

									</div>
								</div>

							</div>



							<div class="carousel-item col">

								<div class="row">
									<div class="col-12 col-lg-7">
										<img src="imgs/index-baby.jpg"
											class="img-fluid pie-carousel-img" alt="...">
									</div>
									<div
										class="col-12 col-lg-5 mt-5 mt-lg-0 d-flex align-items-center justify-content-end">
										<div class="d-flex flex-column align-items-center mx-3 w-100">
											<h3
												class="pie-c-red p-3 font-weight-bold pie-carousel-subtitle">내 파이는 똑소리나게!</h3>
											<img src="imgs/pietext.png" alt=""
												class="d-block pie-carousel-title" />
											<p
												class="pie-c-darkgray text-center px-3 mt-5 pie-carousel-text">
												가격은 나눠도 내 몫은 확실하게. <br /> 깔끔하고 확실한 공유, 파이에서 해드릴게요.
											</p>
											<h5 class="px-3 m-0 pie-carousel-subtext">공유 플랜 서비스도 저렴하게 즐겨요!</h5>
										</div>

									</div>
								</div>

							</div>


						</div>

					</div>


					<div class="row">
						<div class="col-lg-5 offset-lg-7">
							<ol
								class="row justify-content-center carousel-indicators text-center font-weight-bold h5">
								<li class="active" role="button" data-target="#section1Carousel"
									data-slide-to="0">나누다</li>
								<li role="button" data-target="#section1Carousel"
									data-slide-to="1">함께하다</li>
								<li role="button" data-target="#section1Carousel"
									data-slide-to="2">파이하다</li>
							</ol>
						</div>
					</div>
				</div>

			</div>

		</div>

	</section>
</div>


<!-- main fragment -->
<div th:fragment="mainPageContents" class="container-fluid p-0">

	<!-- ###############################################
secion1 #sec1 - 우리동네 공동구매 영역
############################################### -->
	
	<section class="pie-section-py pie-bg-red-light">
		<div class="container">


			<div class="row">

				<div class="col">

					<div
						class="d-flex align-items-center justify-content-between w-100 my-5">
						<h1 class="text-center text-sm-left font-weight-bolder pie-c-red">우리동네
							파이</h1>
						<a class="btn btn-light" href="townBuySearch"> <small>┼</small></a>
					</div>

					<div
						class="d-flex align-items-center justify-content-between w-100">
						<ol class="list-unstyled d-flex pie-tab-btn">
							<li
								class="btn pie-btn-outline-red-custom rounded-pill mr-2 active"
								data-btntarget="#pie-best-hits"># 조회수 BEST 9</li>
							<li class="btn pie-btn-outline-red-custom rounded-pill"
								data-btntarget="#pie-best-likes"># 좋아요 BEST 9</li>
						</ol>
					</div>


					<div class="row pie-town-tabs" id="pie-best-hits">
						<div class="col">
							<div class="card-columns">

								<!-- 최대 노출은 12개까지만 하고, 더보기 버튼으로 페이지 이동  &lt;로 갯수 설정함  -->

								<div th:if="${#lists.isEmpty(tlist)}">
									<!-- 리스트가 비어있을 때 표시할 내용 -->
									<p>게시글이 없습니다.</p>
								</div>
								<div th:if="${not #lists.isEmpty(tlist)}">
									<div th:each="tBoard, iterStat : ${tlist}"
										th:if="${iterStat.index} &lt; 9">
										<a
											class="card shadow hj-radius-30 hj-main_town_hover border-0"
											th:href="@{'townBuyproduct?num=' + ${tBoard.getTo_num()}}">
											<img
											th:src="@{'/imgs/test/' + ${tBoard.getTo_productImg().substring(0,tBoard.getTo_productImg().indexOf('/'))}}"
											class="card-img-top hj-radius-30 hj-main-product-img"
											alt="...">

											<div
												class="position-absolute d-none p-4 hj-main_town_hover_text">
												<div class="d-flex align-items-center">
													<span class="pie_view-icon active pie-icons"></span> <span
														th:text="${tBoard.getTo_hit()}"
														class="h6 mb-0 ml-2 pie-c-darkgray font-weight-bold"></span>
												</div>
											</div>

											<div
												class="position-absolute d-none p-4 hj-main_town_hover_text">
												<p class="pie-c-red m-0 small"
													th:text="${tBoard.getTo_category}"></p>
												<h5 th:text="${tBoard.getTo_title}" class="font-weight-bold"></h5>

												<div class="row">
													<div class="col w-100 d-flex align-items-center">
														<img
															th:src="@{'imgs/profiles/'+${tBoard.getTo_profileImg()}}"
															alt="" class="pie-profilePic mr-2" />
														<h6 class="m-0" th:text="${tBoard.getTo_nickname}"></h6>
													</div>
												</div>
											</div>
										</a>
									</div>
								</div>

							</div>
						</div>
					</div>

				</div>
			</div>



			<div class="row pie-town-tabs d-none" id="pie-best-likes">
				<div class="col">

					<div class="card-columns">

						<div th:if="${#lists.isEmpty(tlist2)}">
							<!-- 리스트가 비어있을 때 표시할 내용 -->
							<p>게시글이 없습니다.</p>
						</div>
						<div th:if="${not #lists.isEmpty(tlist2)}">
							<div th:each="t2Board, iterStat : ${tlist2}"
								th:if="${iterStat.index} &lt; 9">
								<a class="card shadow hj-radius-30 hj-main_town_hover border-0"
									th:href="@{'townBuyproduct?num=' + ${t2Board.getTo_num()}}">
									<img
									th:src="@{'/imgs/test/' + ${t2Board.getTo_productImg().substring(0,t2Board.getTo_productImg().indexOf('/'))}}"
									class="card-img-top hj-radius-30 hj-main-product-img" alt="...">

									<div class="position-absolute d-none p-4 hj-main_town_hover_text">
										<div class="d-flex align-items-center">
											<span class="pie-heart-icon active pie-icons"></span> <span
												th:text="${t2Board.getTo_like()}"
												class="h6 mb-0 ml-2 pie-c-darkgray font-weight-bold"></span>
										</div>
									</div>

									<div class="position-absolute d-none p-4 hj-main_town_hover_text">

										<p class="pie-c-red small m-0 small"
											th:text="${t2Board.getTo_category}"></p>
										<h5 th:text="${t2Board.getTo_title}" class="font-weight-bold"></h5>

										<div class="row">
											<div class="col w-100 d-flex align-items-center">
												<img
													th:src="@{'imgs/profiles/'+${t2Board.getTo_profileImg()}}"
													alt="" class="hj-chat-proImg-small mr-2" />
												<h6 class="m-0" th:text="${t2Board.getTo_nickname}"></h6>
											</div>
										</div>

									</div>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>




		</div>

	</section>


	<!-- ###############################################
secion2 #sec2 - 대리공구 영역
############################################### -->


	<section id="sec2" class="pie-section-py">

		<div class="container ">

			<div
				class="d-flex align-items-center justify-content-between w-100 my-5">
				<h1 class="text-center text-sm-left font-weight-bolder pie-c-red"> 오늘의 파이박스!</h1>
				<a class="btn btn-light" href="proxyBuyProducts"> <small>┼</small>
				</a>
			</div>
			<th:block th:if="${list==null||list.size()==0}">
				<div class="row">
					<div class="col">
						<hr class="my-5" />
						<p class="lead py-5">현재 작성된 글이 없습니다.</p>
						<hr class="my-5" />
					</div>
				</div>
			</th:block>


			<th:block th:if="${list!=null && list.size()!=0}">
				<div class="row hyej-best-gallery align-items-center">
					<div class="col-lg-6 col-md-8 mb-3 mb-md-2">
						<img src="imgs/bestMark.png" alt="best" id="bestMark"
							class="position-absolute" />
						<div class="container-fluid hyej-customCard pt-1 bg-white shadow">
							<div class="row border-bottom">
								<div class="col-12 px-5 py-3 d-flex align-items-center">
									<img th:src="@{'imgs/profiles/'+${list[0].getPr_profileImg()}}"
										class=" border rounded-circle pie-profilePic-mid align-self-center"
										id="bestProfileImg" alt=>
									<div class="pl-3 pie-view-text pie-omitted d-flex flex-column">
										<small class="m-0 font-weight-bold"
											th:text="${list[0].getPr_nickname()}" id="bestNickName">아이디</small>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col p-0">
									<div id="proxyMainCarousel" class="carousel slide"
										data-ride="carousel">
										<ol class="carousel-indicators">
											<th:block
												th:each="i : ${#numbers.sequence(0,list[0].getPr_productImgs().length-1)}">
												<li data-target="#proxyMainCarousel"
													th:attr="data-slide-to=${i}"></li>
											</th:block>
										</ol>
										<div class="carousel-inner">
											<th:block th:each="img : ${list[0].getPr_productImgs()}">
												<div class="carousel-item">
													<img th:src="@{'imgs/test/'+${img}}" class="d-block w-100"
														alt="...">
												</div>
											</th:block>

										</div>
										<button class="carousel-control-prev" type="button"
											data-target="#proxyMainCarousel" data-slide="prev">
											<span class="carousel-control-prev-icon" aria-hidden="true"></span>
											<span class="sr-only">Previous</span>
										</button>
										<button class="carousel-control-next" type="button"
											data-target="#proxyMainCarousel" data-slide="next">
											<span class="carousel-control-next-icon" aria-hidden="true"></span>
											<span class="sr-only">Next</span>
										</button>
									</div>
								</div>
							</div>
							<div class="row px-5 pt-5">
								<div class="col">
									<p class="mb-1 pie-c-red font-weight-bolder">
										<small id="bestCategory" th:text="${list[0].getPr_category()}"></small>
									</p>
									<h4 id="bestTitle" class="text-truncate mb-4"
										th:text="${list[0].getPr_title()}"></h4>
									<div id="bestContent" class="hyej-text-truncate">
										<p th:text="${list[0].getPr_content()}"></p>
									</div>
									<div class="">
										<small id="bestTags"> <th:block
												th:if="${list[0].getPr_tags()!=null}">
												<th:block
													th:each="i: ${#numbers.sequence(1, list[0].getPr_tags()?.length - 1)}">
													<span class="badge badge-light"
														th:text="|#${list[0].getPr_tags()[i]}|">#태그</span>
												</th:block>
											</th:block>
										</small>
									</div>
									<div class="d-flex justify-content-end">
										<div class="d-flex align-items-center">
											<span class="pie-heart-icon active pie-icons mr-2"></span> <span
												id="bestLike" th:text=${list[0].getPr_like()}></span>
										</div>
										<div class="d-flex align-items-center mx-3">
											<span class="pie_view-icon active pie-icons mr-2"></span> <span
												id="bestHit" th:text=${list[0].getPr_hit()}></span>
										</div>
										<div class="d-flex align-items-center">
											<span class="pie-man-icon active pie-icons mr-2"></span> <span
												id="bestNow" th:text=${list[0].getPr_personnelNow()}></span>
											<span>/</span> <span id="bestMax"
												th:text=${list[0].getPr_personnelMax()}></span>
										</div>
									</div>
								</div>
							</div>
							<div class="row px-5 py-5">
								<div class="col">
									<a th:href="@{'viewProxyBoard?num='+${list[0].getPr_num()}}"
										class="btn pie-btn-red btn-block" id="bestBtn">보러가기</a>
								</div>
							</div>

						</div>
					</div>
					<div class="col-lg-6 col-md-4 px-5">
						<div class="row no-gutters justify-content-center bests">
							<th:block th:each="board : ${list}">
								<div class="col-md-12 col-2 mx-2 mx-md-0 mb-md-4 bestProduct">
									<div class="hyej-custom-img-box position-relative">
										<img
											th:src="@{'/imgs/test/' + ${board.getPr_productImg().substring(0,board.getPr_productImg().indexOf('/'))}}"
											alt="" class="shadow" />
										<div class="hyej-cover">
											<p class="d-none d-lg-block m-0 pie-c-lightgray"
												th:text="${board.getPr_category()}"></p>
											<h4 class="d-none d-lg-block text-truncate"
												th:text="${board.getPr_title()}"></h4>
										</div>
									</div>
								</div>
							</th:block>
						</div>
					</div>
				</div>
			</th:block>
		</div>
	</section>


	<!-- ###############################################
secion2 #sec3 - 서비스 공유 영역
############################################### -->

	<section class="pie-section-py bg-light overflow-hidden">

		<div class="container">
			<div class="row">
				<div class="col">
					<div
						class="d-flex align-items-center justify-content-between w-100 my-5">
						<h1 class="text-center text-sm-left font-weight-bolder pie-c-red">즐겨요
							파이타임!</h1>
						<a class="btn btn-light border" href="shareServiceBoard"> <small>┼</small>
						</a>
					</div>
				</div>
			</div>
		</div>

<<<<<<< HEAD
		<div class="row position-relative hyej-carousel-custom pb-5 mb-5">
			<div class="col pb-5 mb-5">
				<div class="owl-carousel owl-theme">
					<div class="item">
						<h4>
							<a href="shareServiceBoard?num=1">													
								<img src="imgs/netflix2.png" alt="" class="img-fluid" style="height:500px">
							</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=1">													
							<img src="imgs/watcha.jpg" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4>
							<a href="shareServiceBoard?num=2">							
								<img src="imgs/xbox.jpg" alt="" class="img-fluid" style="height:500px">
							</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=3">													
							<img src="imgs/ridibooks.jpg" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=1">													
							<img src="imgs/youtube.webp" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4 class="">
						<a href="shareServiceBoard?num=1">													
							<img src="imgs/disney.png" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=2">													
							<img src="imgs/steam.jpg" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=3">													
							<img src="imgs/spotify.jpg" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=2">													
							<img src="imgs/nintendoOnline.jpeg" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
					</div>
					<div class="item">
						<h4>
						<a href="shareServiceBoard?num=3">													
							<img src="imgs/milli.jpg" alt="" class="img-fluid" style="height:500px">
						</a>
						</h4>
=======
		<div class="container-fluid">
			<div class="row position-relative hyej-carousel-custom pb-5 mb-5">
				<div class="col pb-5 mb-5 px-0">
					<div class="owl-carousel owl-theme">
						<div class="item">

							<img src="imgs/netflix2.png" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/watcha.jpg" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/xbox.jpg" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/ridibooks.jpg" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/youtube.webp" alt="" class="img-fluid">

						</div>
						<div class="item">
							<img src="imgs/disney.png" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/steam.jpg" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/spotify.jpg" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/nintendoOnline.jpeg" alt="" class="img-fluid">

						</div>
						<div class="item">

							<img src="imgs/milli.jpg" alt="" class="img-fluid">

						</div>
>>>>>>> branch 'develop' of https://github.com/pieProject-Co-buying/pie.git
					</div>
				</div>
			</div>
		</div>

	</section>


	<script type="text/javascript" th:inline="javascript">
		var list = /*[[${list}]]*/[];
		console.log(list);
	</script>
	<script>
		$(function() {
			$("#proxyMainCarousel").find(".carousel-item").eq(0).addClass(
					"active");
			$("#proxyMainCarousel").find("li").eq(0).addClass("active");

			$(".bests").find(".bestProduct").eq(0).hide();

			$(".bests")
					.find(".bestProduct")
					.click(
							function() {
								$(".bests").find(".bestProduct").show();
								let idx = $(this).index();
								$("#bestProfileImg").attr(
										"src",
										'imgs/profiles/'
												+ list[idx].pr_profileImg);
								$("#bestNickName").text(list[idx].pr_nickname);
								$("#bestTitle").text(list[idx].pr_title);
								$("#bestLike").text(list[idx].pr_like);
								$("#bestHit").text(list[idx].pr_hit);
								$("#bestNow").text(list[idx].pr_personnelNow);
								$("#bestMax").text(list[idx].pr_personnelMax);
								$("#bestCategory").text(list[idx].pr_category)

								$("#bestTags").empty();

								console.log(list[idx].pr_tags);
								if (list[idx].pr_tags != null) {
									for (i = 1; i < list[idx].pr_tags.length; i++) {
										$("#bestTags").append(
												'<span class="badge badge-light">#'
														+ list[idx].pr_tags[i]
														+ '</span>')
									}
								}

								let el = list[idx].pr_content;
								const newText = el.replace(/<[^>]*>?/g, '');

								console.log(newText);

								$("#bestContent")
										.html("<p>" + newText + "</p>");
								$("#bestBtn").attr(
										"href",
										'viewProxyBoard?num='
												+ list[idx].pr_num);
								$("#proxyMainCarousel").find(
										".carousel-indicators").empty();
								for (i = 0; i < list[idx].pr_productImgs.length; i++) {
									$("#proxyMainCarousel")
											.find(".carousel-indicators")
											.append(
													'<li data-target="#proxyMainCarousel" data-slide-to="'+i+'"></li>');
								}
								$("#proxyMainCarousel").find("li").eq(0)
										.addClass("active");
								$("#proxyMainCarousel").find(".carousel-inner")
										.empty();
								for (i = 0; i < list[idx].pr_productImgs.length; i++) {
									$("#proxyMainCarousel")
											.find(".carousel-inner")
											.append(
													'<div class="carousel-item"><img src="imgs/test/'+list[idx].pr_productImgs[i]+'" class="d-block w-100" alt="..."></div>');
								}
								$("#proxyMainCarousel").find(".carousel-item")
										.eq(0).addClass("active");
								$(this).hide();
							})
		})
	</script>

	<!-- bootstrap 기본 carousel 설정으로 처리함 -->
	<!-- <script src="js/main_town_caruousel.js"></script> -->


	<script>
		/* 호버시 제품 제목 보이게 */
		$(document).ready(function() {
			btns = $(".pie-tab-btn li");

			btns.click(function() {
				let clickedtab = $(this).attr("data-btntarget");
				console.log(clickedtab);
				btns.removeClass("active");
				$(this).addClass("active");
				$(".pie-town-tabs").toggleClass("d-none");
			})

			$('.hj-main_town_hover').hover(

			function() {
				$(this).find('.position-absolute').removeClass('d-none');
			},

			function() {
				$(this).find('.position-absolute').addClass('d-none');
			});
		});
	</script>
</div>

</html>