<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/townBuying}">

<div layout:fragment="townBuyContent">


	<!-- #################################################

	카테고리 클릭시 이동 될 페이지

	################################################# -->


	<!-- #################################################
	
	[ 수정 예정사항 ]
	

	# 선택시 선택된 카테고리 active

	----------------------------------------------------------

	[ 백엔드 영역 ]

	
	# 6개 노출 후 더보기 버튼으로 추가 상품 보이는 로직으로 동일하게 감

	################################################# -->



	<div class="container-fluid px-0">





		<div class="container">

			<div class="row mt-5 mb-4">


				<div class="col-12">

					<h1 class="text-center">어떤 공구를 찾으세요?</h1>

				</div>


			</div>

		</div>


		<!-- 검색창 및 #태그 -->

		<div class="container mb-5">

					
					<form action="searchTownBuy" class="pie-search mb-4" method="get" name="searchForm">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
						<input type="hidden" />
						
						<div class="dropdown" id="selectCategory">
						
							<a class="btn dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false">카테고리 </a>
							
							<div class="dropdown-menu">
							
															
								<a class="dropdown-item">식품</a>
								<a class="dropdown-item">육아</a>
								<a class="dropdown-item">뷰티/패션</a>							
								<a class="dropdown-item">반려동물</a>
								<a class="dropdown-item">생활</a>
								<a class="dropdown-item">기타</a>		
								
															
							</div>
							
							
							
						</div>
						
						<input type="text" name="townKeyword" id="townKeyword" class="flex-fill">
						
						<button type="submit"></button>
						
					</form>
	



			<div class="row">

				<div class="col text-center">


					<button type="button" class="btn btn-secondary m-1">#코스트코</button>
					<button type="button" class="btn btn-secondary m-1">#트레이더스</button>
					<button type="button" class="btn btn-secondary m-1">#이마트</button>
					<button type="button" class="btn btn-secondary m-1">#코스트코</button>
					<button type="button" class="btn btn-secondary m-1">#트레이더스</button>
					<button type="button" class="btn btn-secondary m-1">#이마트</button>

				</div>

			</div>


		</div>
		<!-- 검색창 및 #태그 -->



		<!-- 카테고리 -->
		<!-- 이미지 아닌 특수문자로 배치 예정 -->




		<div class="container mb-5">

			<div class="row">

	
					<div class="col-4 col-md-2 d-flex justify-content-center align-items-center">
						<a  href="/townBuyingCategoryChoice?category=food" class="text-dark">
							<img src="imgs/category/ct_best.png" class="img-fluid mx-auto d-block w-50" alt="...">
							<p class="text-center">식품</p>
						</a>
					</div>
	
					<div class="col-4 col-md-2 d-flex justify-content-center align-items-center">
						<a  href="/townBuyingCategoryChoice?category=baby" class="text-dark">
							<img src="imgs/category/ct_food.png" class="img-fluid mx-auto d-block w-50" alt="...">
							<p class="text-center">육아</p>
						</a>
					</div>
	
					<div class="col-4 col-md-2 d-flex justify-content-center align-items-center">
						<a  href="/townBuyingCategoryChoice?category=beautyAndFashion" class="text-dark">
							<img src="imgs/category/ct_winter.png" class="img-fluid mx-auto d-block w-50" alt="...">
							<p class="text-center">뷰티/패션</p>
						</a>
					</div>
	
					<div class="col-4 col-md-2 d-flex justify-content-center align-items-center">
						<a  href="/townBuyingCategoryChoice?category=petf" class="text-dark">
							<img src="imgs/category/ct_kids.png" class="img-fluid mx-auto d-block w-50" alt="...">
							<p class="text-center">반려동물</p>
						</a>
					</div>
	
					<div class="col-4 col-md-2 d-flex justify-content-center align-items-center">
						<a  href="/townBuyingCategoryChoice?category=life" class="text-dark">
							<img src="imgs/category/ct_innerB.png" class="img-fluid mx-auto d-block w-50" alt="...">
							<p class="text-center">생활</p>
						</a>
					</div>
	
					<div class="col-4 col-md-2 d-flex justify-content-center align-items-center">
						<a  href="/townBuyingCategoryChoice?category=etc" class="text-dark">
							<img src="imgs/category/ct_cosme.png" class="img-fluid mx-auto d-block w-50" alt="...">
							<p class="text-center">기타</p>
						</a>
					</div>
	

			</div>





		</div>







		<div class="container mb-5">



			<div class="row mb-5">



				<div class="card-columns">

					<div class="card townBuyCard" th:each = "list:${list}">
						<img th:src="@{'/imgs/' + ${list.getTo_productImg()}}" class="card-img-top" alt="...">
						<div class="card-body">
							<h5 class="card-title" th:text="${list.getTo_title()}"></h5>
							<p class="card-text" th:utext="${list.getTo_content()}"></p>

							<div class="row">

								<!-- (n/n => 참여 사용자 수/글쓴이가 설정한 사용자수 ) -->
								<div class="col-6">현재 진행 (1/7)</div>
								<div class="col-6 text-right">
									<a th:href="@{'townBuyproduct?id=' + ${list.getTo_num()}}" class="btn btn-outline-secondary">같이 사러가기 &raquo;</a>

								</div>

							</div>


						</div>
					</div>



				</div>



				<!-- 초기 로드될 게시물 6개 / 백 작업시 게시글 갯수 6개 넘어갈 시 활성화 및 더보기 누르면 6개 더 보여주기 or 전체 보여주기 -->

				<div class="row mx-auto m-2 mt-5 w-100">
					<div class="col">
					
						<button type="button" class="btn btn-outline-secondary w-100" id="loadMoreButton">더보기</button>
	
					</div>
				</div>



			</div>


		</div>




	</div>
	
	

	<script>
	
	
	document.addEventListener('DOMContentLoaded', function() {
	    // 페이지가 로드될 때 처음 6개의 카드만 보이도록 설정
	    showInitialCards(6);
	    
	    // 더보기 버튼 클릭 이벤트 추가
	    document.getElementById('loadMoreButton').addEventListener('click', loadMoreCards);
	});

	function showInitialCards(numToShow) {
	    const allCards = document.querySelectorAll('.townBuyCard');
	    // 처음에 표시할 카드 수만큼만 보이도록 설정
	    for (let i = 0; i < allCards.length; i++) {
	        if (i < numToShow) {
	            allCards[i].style.display = 'block';
	        } else {
	            allCards[i].style.display = 'none';
	        }
	    }
	}

	function loadMoreCards() {
	    // 추가 카드를 가져오는 로직 구현
	    // 이 부분은 서버에서 데이터를 가져와서 새로운 카드를 생성하고 추가
	    // 여기서는 예시로 각 카드의 display 속성을 변경하여 가상으로 추가
	    const additionalCards = document.querySelectorAll('.townBuyCard:not([style="display: block;"])');
	    const numToShow = 6; // 한 번에 보여줄 추가 카드의 수
	    let cardsToShow = 0;
	    for (let i = 0; i < additionalCards.length; i++) {
	        if (cardsToShow < numToShow) {
	            additionalCards[i].style.display = 'block';
	            cardsToShow++;
	        } else {
	            break;
	        }
	    }
	    
	    
	    // 모든 카드를 보여주었는지 확인
	    if (cardsToShow === 0) {
	    	document.getElementById('loadMoreButton').style.display = 'none';
	    }
	    
	}
	
	
	
	// 선택한 카테고리 보여지게 하는 기능
    $(document).on('click', '.dropdown-menu .dropdown-item', function(){
        let selectedCategory = $(this).text();
        $(this).closest('.dropdown').find('.dropdown-toggle').text(selectedCategory);
    });		
		
	
	</script>
	
	
	
</div>


</html>