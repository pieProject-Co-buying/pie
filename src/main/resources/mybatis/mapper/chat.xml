<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.pie.pieProject.DAO.IChatDao">
	
	
	<!-- 메세지 저장 -->
	<insert id="saveMsg" parameterType="java.util.Map">
        INSERT INTO pie_messages (roomName, roomNumber, sender_id, sender, message, sendTime) VALUES (#{roomName}, #{roomNumber}, #{userId}, #{userName}, #{message}, sysdate)
    </insert>
	
	
	
	
	<!-- 채팅방 생성 -->
	<insert id="insertRoom">
        INSERT INTO pie_chatRoom (roomNumber, roomName, partyMem) VALUES (#{roomNumber}, #{roomName}, #{nickName})
    </insert>
    
    
    <!-- 채팅방 목록 불러오기 -->
	<select id="roomList" resultType="com.pie.pieProject.DTO.RoomDto">
		select * from pie_chatRoom order by roomNumber asc
	</select>
	
	   <!-- 채팅방 목록 불러오기 -->
	<select id="room" resultType="com.pie.pieProject.DTO.RoomDto">
		select * from pie_chatRoom where partyMem = #{param1}
	</select>
	
	
	<select id="roomListByID" resultType="com.pie.pieProject.DTO.RoomDto">
		select * from pie_chatRoom where partyMem = '@${param1}@${param2}' or partyMem = '@${param2}@${param1}'
	</select>
	
	<select id="roomListByMine" resultType="com.pie.pieProject.DTO.RoomDto">
		select * from pie_chatRoom where partyMem like '%@${param1}@%' or partyMem like '%@${param1}' order by roomnumber desc
	</select>
	
	
	<select id="chatList" resultType="com.pie.pieProject.DTO.ChatDto">
		select * from pie_messages where roomNumber = #{roomNumber} order by sendTime asc
	</select>
		
	
	
	

</mapper>