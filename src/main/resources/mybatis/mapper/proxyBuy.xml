<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pie.pieProject.DAO.IProxyBuyDao">
	<select id="listDao"
		resultType="com.pie.pieProject.DTO.ProxyBuyBoardDto">

		select * from proxyBuyBoard order by pr_num desc
	</select>
	<select id="listDaoByNewer"
		resultType="com.pie.pieProject.DTO.ProxyBuyBoardDto">
		select * from proxyBuyBoard order by pr_registDay desc
	</select>
	<select id="listDaoByNewerNumber"
		resultType="com.pie.pieProject.DTO.ProxyBuyBoardDto">
		select * from proxyBuyBoard where ROWNUM <![CDATA[ <= ]]> #{param1} order by pr_registDay desc
	</select>
	<select id="listDaoByCategory"
		resultType="com.pie.pieProject.DTO.ProxyBuyBoardDto">
		select * from proxyBuyBoard where pr_category=#{param1}
		order by pr_updateDay desc
	</select>
	<select id="listDaoByCategoryNumber"
		resultType="com.pie.pieProject.DTO.ProxyBuyBoardDto">
		select * from proxyBuyBoard where pr_category=#{param1} and ROWNUM <![CDATA[ <= ]]> #{param2}
		order by pr_updateDay desc
	</select>
	<select id="getView">
		select * from proxyBuyBoard where pr_num = #{param1}
	</select>
	<insert id="insertProxyBoard">
		insert into proxyBuyBoard values(
		pr_num.nextval,
		#{pr_id},
		#{pr_nickname},
		#{pr_category},
		#{pr_premium},
		#{pr_title},
		#{pr_content},
		#{pr_profileImg},
		#{pr_productImg},
		0,
		#{pr_tag},
		'서울시 중구',
		'1',
		sysdate,
		sysdate,
		TO_DATE(#{pr_deadLine}, 'YYYY-MM-DD'),
		#{pr_personnelMax},
		1,
		#{pr_priceTotal},
		#{pr_pricePer},
		#{pr_ip},
		0
		)
	</insert>
	<update id="updateHit">
	update proxyBuyBoard set pr_hit = pr_hit+1 where pr_num = #{param1} 
	</update>
	
	<select id="checkLike" resultType="_int">
	select count(*)from likeTable where likingId = #{param1} and boardNum=  #{param2} and boardTable = #{param3}
	</select>
	
	<insert id="LikePlus">
	insert into likeTable values(#{param1}, #{param2}, #{param3})
	</insert>
	<delete id="LikeMinus">
	delete likeTable where likingId = #{param1} and boardNum=  #{param2} and boardTable = #{param3}
	</delete>
	<update id="countLike">
	update ${param2} set pr_like = (select count(*) from likeTable where boardNum = #{param1}) where pr_num = #{param1}
	</update>
	

</mapper>